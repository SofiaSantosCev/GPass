<!DOCTYPE html>
<html>
<head>
	<title>CATEGORY</title>
	<link rel="stylesheet" type="text/css" href="main.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body style="background-color: lavender">

	<form id="form">
		<fieldset>
			<label for="name"><b>Name</b></label>
			<input type="text" placeholder="new category name" name="name" required id="name"><br><br>
			<input type="submit" onclick="create()" value="crear categoria">
			
		</fieldset>
	</form>

	<input type="submit" onclick="showCategories()" value="mostrar categorias">
	<div id="">
	<div class="category"></div>
</body>

<script type="text/javascript">
	
	$("#form").submit(function(e){
		e.preventDefault();
	});

	function create() { 
		
		var token = localStorage.getItem("token"); 
		var name = document.getElementById("name").value;

		$.ajax({
			url:"http://localhost:8888/GPASS/public/api/categories",
			type: "POST",

			headers: {
				'Authorization' : token
			},

			data:{
				'name': name,
			},

			success: function(response){
				var categories = response.categories;
				var ids = response.ids;
				show(categories, ids);
			},
			
			error: function() {
				console.log(response.responseText);
			}
		});
	}


	function showCategories(categories, ids){ 
		
		for(var category in categories) {
			$('#categoriesList').append('<div class="category"> 'categories[category]+'<button id="categoriesbtn"' + ids[category]+'"onclick="deleteCategory('+ids[category]+')>Borrar</button></div><br>');
		}


		var token = localStorage.getItem("token"); 
		var name = document.getElementById("name").value;

		$.ajax({
			url:"http://localhost:8888/GPASS/public/api/categories",
			type: "GET",

			headers:{
				'Authorization' : token
			},

			success: function(response){
				console.log(response.responseText);
				
			},
			
			error: function() {
				console.log("Error :(");
			}
		});
	}

</script>
</html>
